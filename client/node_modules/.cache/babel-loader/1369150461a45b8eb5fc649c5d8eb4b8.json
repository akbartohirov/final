{"ast":null,"code":"import _regeneratorRuntime from\"/home/akbar/Desktop/salam/final/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/akbar/Desktop/salam/final/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"/home/akbar/Desktop/salam/final/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/home/akbar/Desktop/salam/final/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/home/akbar/Desktop/salam/final/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useContext}from\"react\";import{useHistory}from\"react-router-dom\";import\"./Auth.css\";import{Link}from\"react-router-dom\";import axios from\"axios\";import AuthContext from\"../Context/AuthContext\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Auth=function Auth(){var _useState=useState({email:\"\",password:\"\"}),_useState2=_slicedToArray(_useState,2),form=_useState2[0],setForm=_useState2[1];var history=useHistory();var auth=useContext(AuthContext);var onChangeHandler=function onChangeHandler(e){setForm(_objectSpread(_objectSpread({},form),{},_defineProperty({},e.target.name,e.target.value)));};var onLogin=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var _yield$axios$post,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();_context.prev=1;_context.next=4;return axios.post(\"/auth/login\",form,{headers:{\"Conent-Type\":\"application/json\"}});case 4:_yield$axios$post=_context.sent;data=_yield$axios$post.data;console.log(data.user.isAdmin);window.M.toast({html:\"Вы успешно вошли\",classes:\"loginToast\"});auth.login(data.token,data.user._id,data.user.isAdmin,data.user.isAdminAddProduct,data.user.isAdminOrderViewer);history.push(\"/\");_context.next=15;break;case 12:_context.prev=12;_context.t0=_context[\"catch\"](1);window.M.toast({html:\"Что то пошло не так\",classes:\"loginToastRed\"});case 15:case\"end\":return _context.stop();}}},_callee,null,[[1,12]]);}));return function onLogin(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{className:\"row mt-2\",children:/*#__PURE__*/_jsxs(\"form\",{className:\"col s12 l4 m4\",style:{position:\"relative\",left:\"50%\",transform:\"translateX(-50%)\"},onSubmit:function onSubmit(e){return onLogin(e);},children:[/*#__PURE__*/_jsx(\"div\",{className:\"row col\",children:/*#__PURE__*/_jsx(\"h3\",{children:\"\\u0412\\u043E\\u0439\\u0442\\u0438\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"input-field col s12\",children:[/*#__PURE__*/_jsx(\"input\",{onChange:function onChange(e){return onChangeHandler(e);},id:\"email\",type:\"email\",name:\"email\",value:form.email,className:\"validate\"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"email\",children:\"\\u042D\\u043B\\u0435\\u043A\\u0442\\u0440\\u043E\\u043D\\u043D\\u0430\\u044F \\u043F\\u043E\\u0447\\u0442\\u0430\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"input-field col s12\",children:[/*#__PURE__*/_jsx(\"input\",{onChange:function onChange(e){return onChangeHandler(e);},id:\"password\",type:\"password\",name:\"password\",className:\"validate\",value:form.password}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"password\",children:\"\\u041F\\u0430\\u0440\\u043E\\u043B\\u044C\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"input-field col s12\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"waves-effect waves-light btn-large mb-3\",children:\"\\u0412\\u043E\\u0439\\u0442\\u0438\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"col s12\",children:[\"\\u0415\\u0441\\u043B\\u0438 \\u043D\\u0435 \\u0437\\u0430\\u0440\\u0435\\u0433\\u0438\\u0441\\u0442\\u0440\\u0438\\u0440\\u043E\\u0432\\u0430\\u043D.\",\" \",/*#__PURE__*/_jsx(Link,{to:\"/register\",className:\"underline\",children:\"\\u0420\\u0435\\u0433\\u0438\\u0441\\u0442\\u0440\\u0430\\u0446\\u0438\\u044F\"}),\" \"]})]})})]})});};export default Auth;","map":{"version":3,"sources":["/home/akbar/Desktop/salam/final/client/src/pages/Auth.js"],"names":["React","useState","useContext","useHistory","Link","axios","AuthContext","Auth","email","password","form","setForm","history","auth","onChangeHandler","e","target","name","value","onLogin","preventDefault","post","headers","data","console","log","user","isAdmin","window","M","toast","html","classes","login","token","_id","isAdminAddProduct","isAdminOrderViewer","push","position","left","transform"],"mappings":"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","sourcesContent":["import React, { useState, useContext } from \"react\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport \"./Auth.css\";\r\nimport { Link } from \"react-router-dom\";\r\nimport axios from \"axios\";\r\nimport AuthContext from \"../Context/AuthContext\";\r\n\r\nconst Auth = () => {\r\n  const [form, setForm] = useState({\r\n    email: \"\",\r\n    password: \"\",\r\n  });\r\n\r\n  const history = useHistory();\r\n\r\n  const auth = useContext(AuthContext);\r\n\r\n  const onChangeHandler = (e) => {\r\n    setForm({\r\n      ...form,\r\n      [e.target.name]: e.target.value,\r\n    });\r\n  };\r\n\r\n  const onLogin = async (e) => {\r\n    e.preventDefault();\r\n    try {\r\n      const { data } = await axios.post(\"/auth/login\", form, {\r\n        headers: {\r\n          \"Conent-Type\": \"application/json\",\r\n        },\r\n      });\r\n\r\n      console.log(data.user.isAdmin);\r\n\r\n      window.M.toast({ html: \"Вы успешно вошли\", classes: \"loginToast\" });\r\n      auth.login(\r\n        data.token,\r\n        data.user._id,\r\n        data.user.isAdmin,\r\n        data.user.isAdminAddProduct,\r\n        data.user.isAdminOrderViewer\r\n      );\r\n      history.push(\"/\");\r\n    } catch (e) {\r\n      window.M.toast({ html: \"Что то пошло не так\", classes: \"loginToastRed\" });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"row mt-2\">\r\n      <form\r\n        className=\"col s12 l4 m4\"\r\n        style={{\r\n          position: \"relative\",\r\n          left: \"50%\",\r\n          transform: \"translateX(-50%)\",\r\n        }}\r\n        onSubmit={(e) => onLogin(e)}\r\n      >\r\n        <div className=\"row col\">\r\n          <h3>Войти</h3>\r\n        </div>\r\n        <div className=\"row\">\r\n          <div className=\"input-field col s12\">\r\n            <input\r\n              onChange={(e) => onChangeHandler(e)}\r\n              id=\"email\"\r\n              type=\"email\"\r\n              name=\"email\"\r\n              value={form.email}\r\n              className=\"validate\"\r\n            />\r\n            <label htmlFor=\"email\">Электронная почта</label>\r\n          </div>\r\n        </div>\r\n        <div className=\"row\">\r\n          <div className=\"input-field col s12\">\r\n            <input\r\n              onChange={(e) => onChangeHandler(e)}\r\n              id=\"password\"\r\n              type=\"password\"\r\n              name=\"password\"\r\n              className=\"validate\"\r\n              value={form.password}\r\n            />\r\n            <label htmlFor=\"password\">Пароль</label>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"row\">\r\n          <div className=\"input-field col s12\">\r\n            <button\r\n              type=\"submit\"\r\n              className=\"waves-effect waves-light btn-large mb-3\"\r\n            >\r\n              Войти\r\n            </button>\r\n            <span className=\"col s12\">\r\n              Если не зарегистрирован.{\" \"}\r\n              <Link to=\"/register\" className=\"underline\">\r\n                Регистрация\r\n              </Link>{\" \"}\r\n            </span>\r\n          </div>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Auth;\r\n"]},"metadata":{},"sourceType":"module"}