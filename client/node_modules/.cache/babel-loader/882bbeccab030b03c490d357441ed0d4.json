{"ast":null,"code":"import _objectSpread from\"/home/akbar/Desktop/salam/final/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/home/akbar/Desktop/salam/final/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React from\"react\";// import AdminSidebar from \"../../../Components/\";\nimport AdminSidebar from\"../../../Components/AdminSidebar\";import\"./AdminUserDetailsPage.css\";import axios from\"axios\";import{useParams}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var AdminUserDetailsPage=function AdminUserDetailsPage(){var _React$useState=React.useState(\"\"),_React$useState2=_slicedToArray(_React$useState,2),name=_React$useState2[0],setName=_React$useState2[1];var _React$useState3=React.useState(\"\"),_React$useState4=_slicedToArray(_React$useState3,2),email=_React$useState4[0],setEmail=_React$useState4[1];var _React$useState5=React.useState(\"\"),_React$useState6=_slicedToArray(_React$useState5,2),phone=_React$useState6[0],setPhone=_React$useState6[1];var _React$useState7=React.useState(false),_React$useState8=_slicedToArray(_React$useState7,2),isAdminAddProduct=_React$useState8[0],setIsAdminAddProduct=_React$useState8[1];var _React$useState9=React.useState(false),_React$useState10=_slicedToArray(_React$useState9,2),isAdminOrderViewer=_React$useState10[0],setIsAdminOrderViewer=_React$useState10[1];var _React$useState11=React.useState(\"\"),_React$useState12=_slicedToArray(_React$useState11,2),password=_React$useState12[0],setPassword=_React$useState12[1];var _React$useState13=React.useState([]),_React$useState14=_slicedToArray(_React$useState13,2),userOrders=_React$useState14[0],setUserOrders=_React$useState14[1];var _useParams=useParams(),id=_useParams.id;React.useEffect(function(){var _JSON$parse=JSON.parse(localStorage.getItem(\"userData\")),token=_JSON$parse.token;axios.get(\"/users/\".concat(id),{headers:{Authorization:\"Bearer \".concat(token)}}).then(function(_ref){var data=_ref.data;setName(data.user.name);setIsAdminAddProduct(data.user.isAdminAddProduct);setIsAdminOrderViewer(data.user.isAdminAddProduct);setEmail(data.user.email);setPhone(data.user.phone);});},[id]);React.useEffect(function(){var _JSON$parse2=JSON.parse(localStorage.getItem(\"userData\")),token=_JSON$parse2.token;axios.get(\"/orders/\".concat(id),{headers:{Authorization:\"Bearer \".concat(token)}}).then(function(_ref2){var data=_ref2.data;var orders=data.flatMap(function(item){var newOrder=item.products.map(function(el){return _objectSpread(_objectSpread({},el),{},{date:item.createdAt});});return newOrder;});setUserOrders(orders);});},[id]);var submitHanler=function submitHanler(e){e.preventDefault();var _JSON$parse3=JSON.parse(localStorage.getItem(\"userData\")),token=_JSON$parse3.token;axios.patch(\"/users/\".concat(id),password?{name:name,email:email,phone:phone,isAdminAddProduct:isAdminAddProduct,isAdminOrderViewer:isAdminOrderViewer,password:password}:{name:name,email:email,phone:phone,isAdminAddProduct:isAdminAddProduct,isAdminOrderViewer:isAdminOrderViewer},{headers:{\"Content-Type\":\"application/json\",Authorization:\"Bearer \".concat(token)}}).then(function(res){window.M.toast({html:\"Имзменения сохранени\",classes:\"loginToast\"});}).catch(function(e){window.M.toast({html:\"Что то прошлоо не так\",classes:\"loginToastRed\"});});};return/*#__PURE__*/_jsxs(\"div\",{className:\"adminPage\",children:[/*#__PURE__*/_jsx(AdminSidebar,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"adminUsersDetailsPage\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"center-align\",children:\"\\u0414\\u0430\\u043D\\u043D\\u044B\\u0435 \\u043F\\u043E\\u043B\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044F\"}),/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsxs(\"form\",{className:\"col m6 offset-m3\",onSubmit:function onSubmit(e){return submitHanler(e);},children:[/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"input-field col s12\",children:[/*#__PURE__*/_jsx(\"input\",{id:\"name\",type:\"text\",className:\"validate\",value:name,onChange:function onChange(e){return setName(e.target.value);}}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"name\",children:\"\\u0418\\u043C\\u044F\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"input-field col s12\",children:[/*#__PURE__*/_jsx(\"input\",{id:\"email\",type:\"email\",className:\"validate\",value:email,onChange:function onChange(e){return setEmail(e.target.value);}}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"email\",children:\"Email \\u0430\\u0434\\u0440\\u0435\\u0441\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"input-field col s12\",children:[/*#__PURE__*/_jsx(\"input\",{id:\"phone\",type:\"number\",className:\"validate\",value:phone,onChange:function onChange(e){return setPhone(e.target.value);}}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"phone\",children:\"\\u0422\\u0435\\u043B. \\u043D\\u043E\\u043C\\u0435\\u0440\"})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col s4\",children:/*#__PURE__*/_jsx(\"p\",{children:/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(\"input\",{onChange:function onChange(e){setIsAdminAddProduct(false);setIsAdminOrderViewer(false);},className:\"with-gap\",name:\"group1\",type:\"radio\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u041E\\u0431\\u044B\\u0447\\u043D\\u044B\\u0439 \\u043F\\u043E\\u043B\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044C\"})]})})}),/*#__PURE__*/_jsx(\"div\",{className:\"col s4\",children:/*#__PURE__*/_jsx(\"p\",{children:/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(\"input\",{className:\"with-gap\",name:\"group1\",onChange:function onChange(e){setIsAdminAddProduct(true);setIsAdminOrderViewer(false);},type:\"radio\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u0410\\u0434\\u043C\\u0438\\u043D 1 \\u0434\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u0442\\u043E\\u0432\\u0430\\u0440\"})]})})}),/*#__PURE__*/_jsx(\"div\",{className:\"col s4\",children:/*#__PURE__*/_jsx(\"p\",{children:/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(\"input\",{className:\"with-gap\",onChange:function onChange(e){setIsAdminOrderViewer(true);setIsAdminAddProduct(false);},name:\"group1\",type:\"radio\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u0410\\u0434\\u043C\\u0438\\u043D 2 \\u0440\\u0430\\u0431\\u043E\\u0442\\u0430\\u0435\\u0442 \\u0437\\u0430\\u043A\\u0430\\u0437\\u0430\\u043C\\u044B\"})]})})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"input-field col s12\",children:[/*#__PURE__*/_jsx(\"input\",{id:\"password\",type:\"password\",className:\"validate\",value:password,onChange:function onChange(e){return setPassword(e.target.value);}}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"password\",children:\"\\u041F\\u0430\\u0440\\u043E\\u043B\\u044C\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsx(\"div\",{className:\"input-field col s12\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn\",type:\"submit\",children:\"\\u0421\\u043E\\u0445\\u0440\\u0430\\u043D\\u0438\\u0442\\u044C\"})})})]})}),/*#__PURE__*/_jsx(\"h4\",{className:\"center-align\",children:\"\\u0417\\u0430\\u043A\\u0443\\u043F\\u044B \\u043F\\u043E\\u043B\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044F\"}),userOrders.length>0&&/*#__PURE__*/_jsxs(\"table\",{children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"\\u2116\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\u0442\\u043E\\u0432\\u0430\\u0440\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\u041D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u0435 \\u0442\\u043E\\u0432\\u0430\\u0440\\u0430\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\u043A\\u043E\\u043B\\u0438\\u0447\\u0435\\u0441\\u0442\\u0432\\u043E\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\u0441\\u0443\\u043C\\u043C\\u0430\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\u0447\\u0438\\u0441\\u043B\\u043E\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:userOrders.map(function(order,index){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:index+1}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"img\",{style:{width:\"100px\"},src:\"/\".concat(order.img[0].path),alt:order.title})}),/*#__PURE__*/_jsx(\"th\",{children:order.title}),/*#__PURE__*/_jsx(\"th\",{children:order.quantity}),/*#__PURE__*/_jsxs(\"th\",{children:[order.quantity*order.price,\" \\u0441\\u0443\\u043C\"]}),/*#__PURE__*/_jsx(\"th\",{children:new Date(order.date).toDateString()})]},index+1);})})]})]})]});};export default AdminUserDetailsPage;","map":{"version":3,"sources":["/home/akbar/Desktop/salam/final/client/src/pages/adminpages/admindetailspage/AdminUserDetailsPage.js"],"names":["React","AdminSidebar","axios","useParams","AdminUserDetailsPage","useState","name","setName","email","setEmail","phone","setPhone","isAdminAddProduct","setIsAdminAddProduct","isAdminOrderViewer","setIsAdminOrderViewer","password","setPassword","userOrders","setUserOrders","id","useEffect","JSON","parse","localStorage","getItem","token","get","headers","Authorization","then","data","user","orders","flatMap","item","newOrder","products","map","el","date","createdAt","submitHanler","e","preventDefault","patch","res","window","M","toast","html","classes","catch","target","value","length","order","index","width","img","path","title","quantity","price","Date","toDateString"],"mappings":"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","sourcesContent":["import React from \"react\";\n// import AdminSidebar from \"../../../Components/\";\nimport AdminSidebar from \"../../../Components/AdminSidebar\";\nimport \"./AdminUserDetailsPage.css\";\nimport axios from \"axios\";\nimport { useParams } from \"react-router-dom\";\n\nconst AdminUserDetailsPage = () => {\n  const [name, setName] = React.useState(\"\");\n  const [email, setEmail] = React.useState(\"\");\n  const [phone, setPhone] = React.useState(\"\");\n  const [isAdminAddProduct, setIsAdminAddProduct] = React.useState(false);\n  const [isAdminOrderViewer, setIsAdminOrderViewer] = React.useState(false);\n  const [password, setPassword] = React.useState(\"\");\n  const [userOrders, setUserOrders] = React.useState([]);\n\n  const { id } = useParams();\n\n  React.useEffect(() => {\n    const { token } = JSON.parse(localStorage.getItem(\"userData\"));\n\n    axios\n      .get(`/users/${id}`, {\n        headers: {\n          Authorization: `Bearer ${token}`,\n        },\n      })\n      .then(({ data }) => {\n        setName(data.user.name);\n        setIsAdminAddProduct(data.user.isAdminAddProduct);\n        setIsAdminOrderViewer(data.user.isAdminAddProduct);\n        setEmail(data.user.email);\n        setPhone(data.user.phone);\n      });\n  }, [id]);\n\n  React.useEffect(() => {\n    const { token } = JSON.parse(localStorage.getItem(\"userData\"));\n\n    axios\n      .get(`/orders/${id}`, {\n        headers: {\n          Authorization: `Bearer ${token}`,\n        },\n      })\n      .then(({ data }) => {\n        const orders = data.flatMap((item) => {\n          const newOrder = item.products.map((el) => {\n            return { ...el, date: item.createdAt };\n          });\n          return newOrder;\n        });\n\n        setUserOrders(orders);\n      });\n  }, [id]);\n\n  const submitHanler = (e) => {\n    e.preventDefault();\n    const { token } = JSON.parse(localStorage.getItem(\"userData\"));\n\n    axios\n      .patch(\n        `/users/${id}`,\n        password\n          ? {\n              name,\n              email,\n              phone,\n              isAdminAddProduct,\n              isAdminOrderViewer,\n              password,\n            }\n          : { name, email, phone, isAdminAddProduct, isAdminOrderViewer },\n        {\n          headers: {\n            \"Content-Type\": \"application/json\",\n            Authorization: `Bearer ${token}`,\n          },\n        }\n      )\n      .then((res) => {\n        window.M.toast({ html: \"Имзменения сохранени\", classes: \"loginToast\" });\n      })\n      .catch((e) => {\n        window.M.toast({\n          html: \"Что то прошлоо не так\",\n          classes: \"loginToastRed\",\n        });\n      });\n  };\n\n  return (\n    <div className=\"adminPage\">\n      <AdminSidebar />\n      <div className=\"adminUsersDetailsPage\">\n        <h4 className=\"center-align\">Данные ползователя</h4>\n        <div className=\"row\">\n          <form className=\"col m6 offset-m3\" onSubmit={(e) => submitHanler(e)}>\n            <div className=\"row\">\n              <div className=\"input-field col s12\">\n                <input\n                  id=\"name\"\n                  type=\"text\"\n                  className=\"validate\"\n                  value={name}\n                  onChange={(e) => setName(e.target.value)}\n                />\n                <label htmlFor=\"name\">Имя</label>\n              </div>\n            </div>\n            <div className=\"row\">\n              <div className=\"input-field col s12\">\n                <input\n                  id=\"email\"\n                  type=\"email\"\n                  className=\"validate\"\n                  value={email}\n                  onChange={(e) => setEmail(e.target.value)}\n                />\n                <label htmlFor=\"email\">Email адрес</label>\n              </div>\n            </div>\n            <div className=\"row\">\n              <div className=\"input-field col s12\">\n                <input\n                  id=\"phone\"\n                  type=\"number\"\n                  className=\"validate\"\n                  value={phone}\n                  onChange={(e) => setPhone(e.target.value)}\n                />\n                <label htmlFor=\"phone\">Тел. номер</label>\n              </div>\n            </div>\n\n            <div className=\"row\">\n              <div className=\"col s4\">\n                <p>\n                  <label>\n                    <input\n                      onChange={(e) => {\n                        setIsAdminAddProduct(false);\n                        setIsAdminOrderViewer(false);\n                      }}\n                      className=\"with-gap\"\n                      name=\"group1\"\n                      type=\"radio\"\n                    />\n                    <span>Обычный ползователь</span>\n                  </label>\n                </p>\n              </div>\n              <div className=\"col s4\">\n                <p>\n                  <label>\n                    <input\n                      className=\"with-gap\"\n                      name=\"group1\"\n                      onChange={(e) => {\n                        setIsAdminAddProduct(true);\n                        setIsAdminOrderViewer(false);\n                      }}\n                      type=\"radio\"\n                    />\n                    <span>Админ 1 добавить товар</span>\n                  </label>\n                </p>\n              </div>\n              <div className=\"col s4\">\n                <p>\n                  <label>\n                    <input\n                      className=\"with-gap\"\n                      onChange={(e) => {\n                        setIsAdminOrderViewer(true);\n                        setIsAdminAddProduct(false);\n                      }}\n                      name=\"group1\"\n                      type=\"radio\"\n                    />\n                    <span>Админ 2 работает заказамы</span>\n                  </label>\n                </p>\n              </div>\n            </div>\n\n            <div className=\"row\">\n              <div className=\"input-field col s12\">\n                <input\n                  id=\"password\"\n                  type=\"password\"\n                  className=\"validate\"\n                  value={password}\n                  onChange={(e) => setPassword(e.target.value)}\n                />\n                <label htmlFor=\"password\">Пароль</label>\n              </div>\n            </div>\n\n            <div className=\"row\">\n              <div className=\"input-field col s12\">\n                <button className=\"btn\" type=\"submit\">\n                  Сохранить\n                </button>\n              </div>\n            </div>\n          </form>\n        </div>\n        <h4 className=\"center-align\">Закупы ползователя</h4>\n        {userOrders.length > 0 && (\n          <table>\n            <thead>\n              <tr>\n                <th>№</th>\n                <th>товар</th>\n                <th>Название товара</th>\n                <th>количество</th>\n                <th>сумма</th>\n                <th>число</th>\n              </tr>\n            </thead>\n\n            <tbody>\n              {userOrders.map((order, index) => (\n                <tr key={index + 1}>\n                  <th>{index + 1}</th>\n                  <th>\n                    <img\n                      style={{ width: \"100px\" }}\n                      src={`/${order.img[0].path}`}\n                      alt={order.title}\n                    />\n                  </th>\n                  <th>{order.title}</th>\n                  <th>{order.quantity}</th>\n                  <th>{order.quantity * order.price} сум</th>\n                  <th>{new Date(order.date).toDateString()}</th>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default AdminUserDetailsPage;\n"]},"metadata":{},"sourceType":"module"}