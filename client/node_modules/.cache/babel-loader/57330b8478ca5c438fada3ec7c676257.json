{"ast":null,"code":"import _toConsumableArray from\"/home/akbar/Desktop/project/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/home/akbar/Desktop/project/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React from\"react\";import\"./HistoryOrders.css\";import axios from\"axios\";import BasketOrderItem from\"../BasketOrderItem\";import{jsx as _jsx}from\"react/jsx-runtime\";var HistoryOrders=function HistoryOrders(){var _React$useState=React.useState([]),_React$useState2=_slicedToArray(_React$useState,2),orders=_React$useState2[0],setOrders=_React$useState2[1];React.useEffect(function(){var user=JSON.parse(localStorage.getItem(\"userData\"));axios.get(\"/orders/\".concat(user.userId),{headers:{\"Content-Type\":\"application/json\",Authorization:user.token}}).then(function(res){return res.data;}).then(function(res){var products=res.map(function(item){return _toConsumableArray(item.products);}).flat(1).map(function(item){return item.productId;});return products;}).then(function(res){axios.post(\"/products/cart\",{products:res},{headers:{\"Content-Type\":\"application/json\"}}).then(function(res){setOrders(res.data);}).catch(function(e){console.log(e.message);});});},[]);return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"div\",{className:\"history-orders\",children:orders.length>0?orders.map(function(order,index){return/*#__PURE__*/_jsx(BasketOrderItem,{data:order},index);}):/*#__PURE__*/_jsx(\"h5\",{children:\"\\u041F\\u043E\\u043A\\u0430 \\u0432 \\u0438\\u0441\\u0442\\u043E\\u0440\\u0438\\u0438 \\u043F\\u043E\\u043A\\u0443\\u043F\\u043E\\u043A \\u043D\\u0438\\u0447\\u0435\\u0433\\u043E \\u043D\\u0435\\u0442\\u0443\"})})});};export default HistoryOrders;","map":{"version":3,"sources":["/home/akbar/Desktop/project/client/src/Components/Dashboard/HistoryOrders.js"],"names":["React","axios","BasketOrderItem","HistoryOrders","useState","orders","setOrders","useEffect","user","JSON","parse","localStorage","getItem","get","userId","headers","Authorization","token","then","res","data","products","map","item","flat","productId","post","catch","e","console","log","message","length","order","index"],"mappings":"0TAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAO,qBAAP,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,eAAP,KAA4B,oBAA5B,C,2CAEA,GAAMC,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,EAAM,qBACEH,KAAK,CAACI,QAAN,CAAe,EAAf,CADF,oDACnBC,MADmB,qBACXC,SADW,qBAG1BN,KAAK,CAACO,SAAN,CAAgB,UAAM,CACpB,GAAMC,CAAAA,IAAI,CAAGC,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,UAArB,CAAX,CAAb,CACAX,KAAK,CACFY,GADH,mBACkBL,IAAI,CAACM,MADvB,EACiC,CAC7BC,OAAO,CAAE,CACP,eAAgB,kBADT,CAEPC,aAAa,CAAER,IAAI,CAACS,KAFb,CADoB,CADjC,EAOGC,IAPH,CAOQ,SAACC,GAAD,CAAS,CACb,MAAOA,CAAAA,GAAG,CAACC,IAAX,CACD,CATH,EAUGF,IAVH,CAUQ,SAACC,GAAD,CAAS,CACb,GAAME,CAAAA,QAAQ,CAAGF,GAAG,CACjBG,GADc,CACV,SAACC,IAAD,4BAAcA,IAAI,CAACF,QAAnB,GADU,EAEdG,IAFc,CAET,CAFS,EAGdF,GAHc,CAGV,SAACC,IAAD,QAAUA,CAAAA,IAAI,CAACE,SAAf,EAHU,CAAjB,CAIA,MAAOJ,CAAAA,QAAP,CACD,CAhBH,EAiBGH,IAjBH,CAiBQ,SAACC,GAAD,CAAS,CACblB,KAAK,CACFyB,IADH,CAEI,gBAFJ,CAGI,CAAEL,QAAQ,CAAEF,GAAZ,CAHJ,CAII,CACEJ,OAAO,CAAE,CACP,eAAgB,kBADT,CADX,CAJJ,EAUGG,IAVH,CAUQ,SAACC,GAAD,CAAS,CACbb,SAAS,CAACa,GAAG,CAACC,IAAL,CAAT,CACD,CAZH,EAaGO,KAbH,CAaS,SAACC,CAAD,CAAO,CACZC,OAAO,CAACC,GAAR,CAAYF,CAAC,CAACG,OAAd,EACD,CAfH,EAgBD,CAlCH,EAmCD,CArCD,CAqCG,EArCH,EAuCA,mBACE,kCACE,YAAK,SAAS,CAAC,gBAAf,UACG1B,MAAM,CAAC2B,MAAP,CAAgB,CAAhB,CACC3B,MAAM,CAACiB,GAAP,CAAW,SAACW,KAAD,CAAQC,KAAR,qBACT,KAAC,eAAD,EAA6B,IAAI,CAAED,KAAnC,EAAsBC,KAAtB,CADS,EAAX,CADD,cAKC,2MANJ,EADF,EADF,CAaD,CAvDD,CAyDA,cAAe/B,CAAAA,aAAf","sourcesContent":["import React from \"react\";\r\nimport \"./HistoryOrders.css\";\r\nimport axios from \"axios\";\r\nimport BasketOrderItem from \"../BasketOrderItem\";\r\n\r\nconst HistoryOrders = () => {\r\n  const [orders, setOrders] = React.useState([]);\r\n\r\n  React.useEffect(() => {\r\n    const user = JSON.parse(localStorage.getItem(\"userData\"));\r\n    axios\r\n      .get(`/orders/${user.userId}`, {\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n          Authorization: user.token,\r\n        },\r\n      })\r\n      .then((res) => {\r\n        return res.data;\r\n      })\r\n      .then((res) => {\r\n        const products = res\r\n          .map((item) => [...item.products])\r\n          .flat(1)\r\n          .map((item) => item.productId);\r\n        return products;\r\n      })\r\n      .then((res) => {\r\n        axios\r\n          .post(\r\n            \"/products/cart\",\r\n            { products: res },\r\n            {\r\n              headers: {\r\n                \"Content-Type\": \"application/json\",\r\n              },\r\n            }\r\n          )\r\n          .then((res) => {\r\n            setOrders(res.data);\r\n          })\r\n          .catch((e) => {\r\n            console.log(e.message);\r\n          });\r\n      });\r\n  }, []);\r\n\r\n  return (\r\n    <div>\r\n      <div className=\"history-orders\">\r\n        {orders.length > 0 ? (\r\n          orders.map((order, index) => (\r\n            <BasketOrderItem key={index} data={order} />\r\n          ))\r\n        ) : (\r\n          <h5>Пока в истории покупок ничего нету</h5>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default HistoryOrders;\r\n"]},"metadata":{},"sourceType":"module"}